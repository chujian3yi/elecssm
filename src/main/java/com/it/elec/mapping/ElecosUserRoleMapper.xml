<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper  namespace="com.it.elec.dao.ElecosUserRoleDao">

<resultMap id="baseResultMap" type="ElecosUser">
  <id property="userId"  column="user_id"/>
  <result property="userName" column="user_name"/>
  <result property="logonName" column="logon_name"/>
  <result property="logonPwd" column="logon_pwd"/>
</resultMap>
<resultMap type="ElecosRole" id="roleResultMap">
	<id property="roleId" column="role_id"/>
	<result property="roleName" column="role_name"/>
	<result property="createTime" column="create_time"/>
	<result property="updateTime" column="update_time"/>
</resultMap>
	<!--find mid&pid by roleId  -->
	<select id="findUserListByRoleId" resultMap="baseResultMap">
	select t_u.user_id ,t_u.user_name,t_u.logon_name,t_u.logon_pwd
		from user_role t_ur inner join elecos_user t_u
	on t_u.user_id = t_ur.user_id
        where t_ur.role_id=#{roleId}
	</select>
	
	<!-- delete -->
	<delete id="delete">
		delete from user_role
		where role_id = #{roleId}
	</delete>
	
	<insert id="save">
		insert into user_role
		<trim prefix="(" suffix=")" suffixOverrides=",">
		<if test="userId!=null ">user_id,</if>
		<if test="roleId!=null ">role_id,</if>
		<if test="createTime!=null ">create_time,</if>
		<if test="updateTime!=null ">update_time,</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
		<if test="userId!=null ">#{userId},</if>
		<if test="roleId!=null ">#{roleId},</if>
		<if test="createTime!=null ">#{createTime},</if>
		<if test="updateTime!=null ">#{updateTime},</if>
		</trim>
	</insert>
	
	<select id="getRoleListByUser" resultMap="roleResultMap">
		select t_r.role_id,t_r.role_name,t_r.create_time,t_r.update_time
		from user_role t_ur inner join elecos_role t_r
		on t_ur.role_id = t_r.role_id
		where t_ur.user_id = #{userId}
	</select>
</mapper>